<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ABC iView Downloader</title>
    <!-- Bootstrap -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"> -->
    <link href="assets/bootstrap-4.4.1.css" rel="stylesheet" type="text/css">
</head>
  <body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
		<a class="navbar-brand" href="#" style="padding-left: 25px">ABC iView Downloder</a>
    </nav>
    <header>
      <div class="jumbotron">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="input-group mb-3">
                <div class="input-group-prepend"> <span class="input-group-text" id="basicaddon1">URL</span> </div>
                <input type="text" class="form-control" placeholder="enter your ABC iView URL here" aria-describedby="basicaddon1">
              </div>
			  <div class="btn-group w-100" role="group">
			    <button type="button" class="btn btn-success w-100 " onclick="add()">Add to list</button>
				  <button type="button" class="btn btn-danger w-100 " onclick='document.getElementById("li").innerHTML= ""'>Clear list</button>
				  <button type="button" class="btn btn-info w-100" onclick='showdownloads()'>Open downloads folder</button>
			  </div><br><br>
			  <ul class="list-group" id="li">
		      </ul>
			  <div class="btn-group d-flex" role="group" aria-label="Justified button group with nested dropdown">
			   
			    <button type="button" class="btn w-100 btn-success" onclick="downloadAll()" id="downbtn">Download</button>
		      </div>
            </div>
        </div>
      </div>
    </header>
  
  <footer class="text-center footer">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <p>Copyright © Fox's Den. ABC iView is copyright of ABC Australia</p>
            <small><p>This program requires Microsoft Visual C++ 2010 SP1 Redistributable (x86) to function.  <a class="" href="#" onclick="runAnEXE('https://download.microsoft.com/download/1/6/5/165255E7-1014-4D0A-B094-B6A430A6BFFC/vcredist_x86.exe', '')" ><small>Download Visual C++ 2010</small></a></p>
            
           </div>
        </div>
      </div>
  </footer>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) --> 
  <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script> -->
  <script src="assets/jquery-3.4.1.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed --> 
<script src="assets/popper.min.js"></script>
  <script src="assets/bootstrap-4.4.1.js"></script>
  <script language="JScript">
	function runAnEXE(uri, param) {
            new ActiveXObject("Shell.Application").ShellExecute(uri, param)
	}
  </script>
<script>
	function showdownloads() {
		aa = window.location.href.substring(0, window.location.href.lastIndexOf('/')) + "/"+"downloads/"
		aa = decodeURIComponent(aa.replace(aa.substring(0,8),""))
		runAnEXE(aa, "")
	}
	
	// Create Element.remove() function if not exist
	if (!('remove' in Element.prototype)) {
    	Element.prototype.remove = function() {	
        	if (this.parentNode) {
            	this.parentNode.removeChild(this);
			}
    };
	}
			function downloadAll(){
            arr = document.querySelector("UL").innerText.replace(/\n/g, '').split("✕").join(" ")
						runAnEXE("assets\\helper.bat", arr)
				} 
	
	
			function add(){
				eleelel = "document.getElementById('"+document.querySelector("input").value+"').remove()"
				document.getElementById("li").innerHTML = document.getElementById("li").innerHTML + '<li id="'+document.querySelector("input").value+'" class="list-group-item d-flex justify-content-between align-items-center">'+document.querySelector("input").value + '<span class="badge badge-danger badge-pill" onclick="'+eleelel+'">✕</span></li>'
			}
		</script>
		<style>
			.list-group-item:last-child{
				    border-bottom-right-radius: 0rem;
    border-bottom-left-radius: 0rem;
			}
			#downbtn{
				border-top-right-radius: 0rem;
    border-top-left-radius: 0rem;
				border: 1px solid rgba(0, 0, 0, 0.125);
			}
			ul{overflow: auto;max-height: 40vh;}body{overflow:hidden;min-height:100vh;background:#e9ecef}footer{
      position:absolute;width: 100vw;
				bottom:10px
			}</style>
  </body>
</html>